### T1

先将读入进来的质数标记为危险的，然后做一遍线性筛，当 $i \times p_j$ 被标记为非质数时，判断一下 $i \times p_j$ 是不是危险的（也就是 $i$ 或 $p_j$ 是危险的）就行。

时间复杂度 $O(n)$。

### T2

直接对每个点它的父亲，由于每个数质因子总数 $\le \log n$，所以每次询问可以暴力跳 LCA。

时间复杂度 $O(n + q \log n)$。

### T3

首先另外一个问题：有多少对 $(x, y)$ 满足 $1 \le x \le y \le n$ 且 $y$ 是 $x$ 的倍数？

可以枚举 $x$，那么 $n$ 以内 $x$ 的倍数就是 $\lfloor \frac{n}{x} \rfloor$，所以答案就是 $\sum\limits_{x = 1}^n \lfloor \frac{n}{x} \rfloor$。

回到原问题：设 $a = y - x, b = y + x$，那么 $x = \frac{b - a}{2}, y = \frac{b + a}{2}$。由于 $y \le n$，所以 $a + b \le 2n$，且 $a < b, a, b$ 奇偶性要相同。

所以枚举 $a$，如果 $a$ 是偶数，那么 $b \le 2n - a$ 且 $b$ 是 $a$ 的倍数的话，$b$ 也一定是偶数。$b$ 的个数就是 $\lfloor \frac{2n - a}{a} \rfloor - 1$，减一是因为 $b$ 不能等于 $a$。

若 $a$ 是奇数，那么刚刚那样算出来的 $b$ 就有可能是偶数，即 $b$ 是 $2a$ 的倍数，那么减去 $\lfloor \frac{n - a}{2a} \rfloor$  就行。

时间复杂度 $O(n)$。

### T4

首先，如果一个长为 $k$ 的序列的最小公倍数是 $i$，那么这个序列的所有元素都是 $i$ 的约数。设 $i$ 的约数有 $d(i)$ 个。

填 $k$ 个 $i$ 的约数的方案是 $g_i = d(i)^k$。但如果要求最小公倍数是 $i$，则这样任意填可能导致最小公倍数不是 $i$，如：$i = 4, k = 3$，填的序列是 $(1, 2, 1)$，那么最小公倍数是 $2$，而不是 $4$。

设最小公倍数是 $i$ 的序列个数是 $f_i$，那么可以先求出 $g_i$（任意填 $i$ 的约数），再减去最终最小公倍数不是 $i$ 的方案数，那么最小公倍数不是 $i$，就一定是 $i$ 的某一个约数 $j$，且最小公倍数是 $j$ 的数组所有元素一定是 $i$ 的约数，也就是它一定会在 $g_i$ 中被算进去。

所以 $f_i = g_i - \sum\limits_{j | i, j \neq i} f_j$。

这样暴力递推的复杂度是 $O(n \log n)$ 的，总时间复杂度 $O(n \log n + n \log k)$。
